import{am as M,a4 as D,V as W,t as h,an as O,r as R}from"./three.module-26828fde.js";const c=new M,a=new D,l=new W,w=new h,v=new h,d=new h,j=new O;class G extends R{constructor(u,p,t){super(),t.style.touchAction="none";let e=null,n=null;const i=[],r=this;function y(){t.addEventListener("pointermove",b),t.addEventListener("pointerdown",x),t.addEventListener("pointerup",f),t.addEventListener("pointerleave",f)}function g(){t.removeEventListener("pointermove",b),t.removeEventListener("pointerdown",x),t.removeEventListener("pointerup",f),t.removeEventListener("pointerleave",f),t.style.cursor=""}function C(){g()}function F(){return u}function L(){return a}function b(s){if(r.enabled!==!1){if(P(s),a.setFromCamera(l,p),e){a.ray.intersectPlane(c,v)&&e.position.copy(v.sub(w).applyMatrix4(j)),r.dispatchEvent({type:"drag",object:e});return}if(s.pointerType==="mouse"||s.pointerType==="pen")if(i.length=0,a.setFromCamera(l,p),a.intersectObjects(u,!0,i),i.length>0){const o=i[0].object;c.setFromNormalAndCoplanarPoint(p.getWorldDirection(c.normal),d.setFromMatrixPosition(o.matrixWorld)),n!==o&&n!==null&&(r.dispatchEvent({type:"hoveroff",object:n}),t.style.cursor="auto",n=null),n!==o&&(r.dispatchEvent({type:"hoveron",object:o}),t.style.cursor="pointer",n=o)}else n!==null&&(r.dispatchEvent({type:"hoveroff",object:n}),t.style.cursor="auto",n=null)}}function x(s){r.enabled!==!1&&(P(s),i.length=0,a.setFromCamera(l,p),a.intersectObjects(u,!0,i),i.length>0&&(e=r.transformGroup===!0?u[0]:i[0].object,c.setFromNormalAndCoplanarPoint(p.getWorldDirection(c.normal),d.setFromMatrixPosition(e.matrixWorld)),a.ray.intersectPlane(c,v)&&(j.copy(e.parent.matrixWorld).invert(),w.copy(v).sub(d.setFromMatrixPosition(e.matrixWorld))),t.style.cursor="move",r.dispatchEvent({type:"dragstart",object:e})))}function f(){r.enabled!==!1&&(e&&(r.dispatchEvent({type:"dragend",object:e}),e=null),t.style.cursor=n?"pointer":"auto")}function P(s){const o=t.getBoundingClientRect();l.x=(s.clientX-o.left)/o.width*2-1,l.y=-(s.clientY-o.top)/o.height*2+1}y(),this.enabled=!0,this.transformGroup=!1,this.activate=y,this.deactivate=g,this.dispose=C,this.getObjects=F,this.getRaycaster=L}}export{G as D};
